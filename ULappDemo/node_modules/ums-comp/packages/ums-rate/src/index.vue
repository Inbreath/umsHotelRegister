<template>
    <div>
        <div class='wrap'>
            <div v-for="item in length"  @click="checkRate(item)">
                <text v-if="flag[item-1]" class="icon checked"
                    :style="iconStyle"
                >&#xe607;</text>
                <text class="icon unchecked" :style="iconStyle" v-else
                >&#xe614;</text>
            </div>
        </div>
    </div>
</template>

<script>
    var dom = weex.requireModule('dom');
    export default{
        data(){
            return {
                flag:[]
            }
        },
        props:{
            size:{
                type:[String,Number],
                default:"48px"
            },
            length:{
                type:Number,
                default:5
            },
            score:{
                type:[String,Number],
                default:0
            },
            readonly:{
                type:Boolean,
                default:false
            }
        },
        computed:{
            iconStyle(){
                let styles={}
                styles.width = this.size
                styles.height = this.size
                styles.fontSize = this.size
                return styles
            }
        },
        beforeCreate(){
            dom.addRule('fontFace',{
                'fontFamily': 'rateIcon',
                'src': "url('../../../static/font/UmsIconFont.ttf')",
            })
        },
        created () {
            if(this.score){
                for(let i=0 ; i<this.length;i++){
                    if(i+1 <= this.score){
                        this.flag.push(true);
                    }else{
                        this.flag.push(false);
                    }
                }
            }else{
                for(let i=0 ; i<this.length ; i++){
                    this.flag.push(false);
                }
            }
        },
        methods:{
            checkRate(index){
                if(this.readonly){
                    return;
                }
                this.flag = [];
                for(let i=0 ; i<this.length;i++){
                    if(i+1 <= index){
                        this.flag.push(true);
                    }else{
                        this.flag.push(false);
                    }
                }
            }
        }
    }
</script>

<style lang='stylus' rel="stylesheet/stylus" scoped>
    @import '../../../src/styles/var'
    .wrap
        flex-direction row
        align-items center
    .icon
        margin-right: 10px
        font-family:rateIcon
    .checked
        color $rate-background-color
    .unchecked
        color: $rate-disable-color
</style>