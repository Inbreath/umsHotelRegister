<template>
  <div class='ums-double-bounce' :style="bounce" v-if="show">
    <div class='wrap' ref='wrap' :style="outerBounce"></div>
    <div class='inner' ref='inner' :style="innerBounce"></div>
  </div>
</template>

<script>
  const animation = weex.requireModule('animation')
  export default {
    data () {
      return {
        innerAnimated: true,
        wrapAnimated: true
      }
    },
    props: {
      show: {
        type: Boolean,
        default: true
      },
      size: {
        type: [String, Number],
        default: '45px'
      },
      spinnerColor: {
        type: String,
        default: "#004684"
      }
    },
    mounted () {
      let {bounceGrowp, bounceDecrease} = this
      let behavior = true
      setInterval(() => {
        bounceGrowp(this.$refs.wrap)
        bounceDecrease(this.$refs.inner)
      }, 1000)
    },
    computed: {
      bounce () {
        let {size} = this
        let borderRadius = parseFloat(size) / 2
        return {
          width: size,
          height: size,
          borderRadius
        }
      },
      outerBounce () {
        let {size, spinnerColor} = this
        let borderRadius = parseFloat(size) / 2
        return {
          width: size,
          height: size,
          borderRadius,
          backgroundColor:spinnerColor
        }
      },
      innerBounce () {
        let {size, spinnerColor} = this
        size = parseFloat(size)
        return {
          width: size / 2,
          height: size / 2,
          borderRadius: size / 4,
          backgroundColor: spinnerColor
        } 
      }
    },
    methods: {
      bounceGrowp (el) {
        animation.transition(el, {
          styles: {
              transform: `scale(1, 1)`,
          },
          duration: 400,
          timingFunction: 'linear'
        }, () => {
            animation.transition(el, {
              styles: {
                  transform: `scale(0.5, 0.5)`,
              },
              duration: 400,
              timingFunction: 'linear'
            })
        })
      },
      bounceDecrease (el) {
        animation.transition(el, {
          styles: {
            transform: `scale(0.5, 0.5)`,
          },
          duration: 400,
          timingFunction: 'linear'
        }, () => {
              animation.transition(el, {
              styles: {
                  transform: `scale(1, 1)`,
              },
              duration: 400,
              timingFunction: 'linear'
            })
        })
      }
    }
  }
</script>

<style lang='stylus' rel="stylesheet/stylus" scoped>
  .ums-double-bounce
    justify-content center
    align-items center
  .wrap
    opacity 0.5
    position absolute
    top: 0px
    left: 0px
    transform scale(0.5, 0.5)
</style>