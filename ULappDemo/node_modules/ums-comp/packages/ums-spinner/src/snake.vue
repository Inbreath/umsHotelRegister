<template>
    <div class="ums-snake" ref="snake" :style="spinnerStyles" v-if="show"></div>
</template>

<script>
    const animation = weex.requireModule('animation')
    export default {
        data () {
            return {}
        },
        props: {
            show: {
                type: Boolean,
                default: true
            },
            size: {
                type: [String, Number],
                default: '45px'
            },
            spinnerColor: {
                type: String,
                default: "#004684"
            },
            thickness: {
                type: [String, Number],
                default: '15px'
            },
            snakeGapColor: {
                type: String,
                default: '#FFF'
            }
        },
        mounted () {
            setTimeout(() => {
                this.infinitRotate()
            },50)
        },
        computed: {
            spinnerStyles () {
                let {size, thickness, spinnerColor, snakeGapColor} = this
                let borderRadius = parseFloat(size) / 2
                return {
                    width: size,
                    height: size, 
                    borderRadius,
                    borderWidth: thickness,
                    borderLeftColor: spinnerColor,
                    borderRightColor: spinnerColor,
                    borderBottomColor: spinnerColor,
                    borderTopColor: snakeGapColor
                }
            }
        },
        methods: {
            infinitRotate (angle = 3600) {
                animation.transition(this.$refs.snake,{
                    styles:{
                        transform:`rotate(${angle}deg)`
                    },
                    duration: angle * 2,
                    timingFunction: 'linear'
                },()=>{
                    if (this.show) {
                        angle *= 100
                        this.infinitRotate(angle)
                    }
                })
            }
        }
    }
</script>

<style lang='stylus' rel="stylesheet/stylus" scoped>
    .ums-snake
        border-top-color: #FFFFFF
        justify-content center
        align-items center
    .wrap
        opacity 0.5
        position absolute
        top: 0px
        left: 0px
        transform scale(0.5, 0.5)
</style>